{
  "standalone_cfg_tests": {
    "simple_case_two_clauses": {
      "mock": "test(X) ->\n    case X of\n        1 -> ok;\n        2 -> error\n    end.",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "test(X)", "type": "Function"},
        {"node_id": "node_2", "code": "case X", "type": "Branch"},
        {"node_id": "node_3", "code": "1", "type": "Branch"},
        {"node_id": "node_4", "code": "ok", "type": "BasicBlock"},
        {"node_id": "node_5", "code": "2", "type": "Branch"},
        {"node_id": "node_6", "code": "error", "type": "BasicBlock"},
        {"node_id": "node_7", "code": "merge", "type": "Merge"},
        {"node_id": "node_8", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_2", "target_id": "node_5"},
        {"source_id": "node_3", "target_id": "node_4"},
        {"source_id": "node_5", "target_id": "node_6"},
        {"source_id": "node_4", "target_id": "node_7"},
        {"source_id": "node_6", "target_id": "node_7"},
        {"source_id": "node_7", "target_id": "node_8"}
      ]
    },
    "case_with_sequential_before_after": {
      "mock": "test(X) ->\n    A = 1,\n    case X of\n        0 -> zero;\n        _ -> other\n    end,\n    done.",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "test(X)", "type": "Function"},
        {"node_id": "node_2", "code": "A = 1", "type": "BasicBlock"},
        {"node_id": "node_3", "code": "case X", "type": "Branch"},
        {"node_id": "node_4", "code": "0", "type": "Branch"},
        {"node_id": "node_5", "code": "zero", "type": "BasicBlock"},
        {"node_id": "node_6", "code": "_", "type": "Branch"},
        {"node_id": "node_7", "code": "other", "type": "BasicBlock"},
        {"node_id": "node_8", "code": "merge", "type": "Merge"},
        {"node_id": "node_9", "code": "done", "type": "BasicBlock"},
        {"node_id": "node_10", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_3", "target_id": "node_4"},
        {"source_id": "node_3", "target_id": "node_6"},
        {"source_id": "node_4", "target_id": "node_5"},
        {"source_id": "node_6", "target_id": "node_7"},
        {"source_id": "node_5", "target_id": "node_8"},
        {"source_id": "node_7", "target_id": "node_8"},
        {"source_id": "node_8", "target_id": "node_9"},
        {"source_id": "node_9", "target_id": "node_10"}
      ]
    },
    "simple_if_two_guards": {
      "mock": "test(X) ->\n    if\n        X > 10 -> big;\n        X > 0 -> small\n    end.",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "test(X)", "type": "Function"},
        {"node_id": "node_2", "code": "X > 10", "type": "Branch"},
        {"node_id": "node_3", "code": "big", "type": "BasicBlock"},
        {"node_id": "node_4", "code": "X > 0", "type": "Branch"},
        {"node_id": "node_5", "code": "small", "type": "BasicBlock"},
        {"node_id": "node_6", "code": "merge", "type": "Merge"},
        {"node_id": "node_7", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_4", "target_id": "node_5"},
        {"source_id": "node_3", "target_id": "node_6"},
        {"source_id": "node_5", "target_id": "node_6"},
        {"source_id": "node_1", "target_id": "node_4"},
        {"source_id": "node_6", "target_id": "node_7"}
      ]
    },
    "if_with_sequential": {
      "mock": "test(X) ->\n    A = 1,\n    if\n        X > 5 -> big;\n        true -> small\n    end,\n    done.",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "test(X)", "type": "Function"},
        {"node_id": "node_2", "code": "A = 1", "type": "BasicBlock"},
        {"node_id": "node_3", "code": "X > 5", "type": "Branch"},
        {"node_id": "node_4", "code": "big", "type": "BasicBlock"},
        {"node_id": "node_5", "code": "true", "type": "Branch"},
        {"node_id": "node_6", "code": "small", "type": "BasicBlock"},
        {"node_id": "node_7", "code": "merge", "type": "Merge"},
        {"node_id": "node_8", "code": "done", "type": "BasicBlock"},
        {"node_id": "node_9", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_2", "target_id": "node_5"},
        {"source_id": "node_3", "target_id": "node_4"},
        {"source_id": "node_5", "target_id": "node_6"},
        {"source_id": "node_4", "target_id": "node_7"},
        {"source_id": "node_6", "target_id": "node_7"},
        {"source_id": "node_7", "target_id": "node_8"},
        {"source_id": "node_8", "target_id": "node_9"}
      ]
    },
    "complex_nested_if_case_multiple_levels": {
      "mock": "process(X, Y, Z) ->\n    A = X + 1,\n    if\n        X > 20 ->\n            B = Y * 2,\n            case B of\n                0 -> zero;\n                N when N > 10 ->\n                    if\n                        Z > 5 -> deep_big;\n                        true -> deep_small\n                    end;\n                _ -> other\n            end,\n            result1;\n        X > 10 ->\n            case Y of\n                ok -> good;\n                error -> bad\n            end;\n        true ->\n            simple\n    end,\n    done.",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "process(X, Y, Z)", "type": "Function"},
        {"node_id": "node_2", "code": "A = X + 1", "type": "BasicBlock"},
        {"node_id": "node_3", "code": "X > 20", "type": "Branch"},
        {"node_id": "node_4", "code": "B = Y * 2", "type": "BasicBlock"},
        {"node_id": "node_5", "code": "case B", "type": "Branch"},
        {"node_id": "node_6", "code": "0", "type": "Branch"},
        {"node_id": "node_7", "code": "zero", "type": "BasicBlock"},
        {"node_id": "node_8", "code": "N", "type": "Branch"},
        {"node_id": "node_9", "code": "N > 10", "type": "Branch"},
        {"node_id": "node_10", "code": "Z > 5", "type": "Branch"},
        {"node_id": "node_11", "code": "deep_big", "type": "BasicBlock"},
        {"node_id": "node_12", "code": "true", "type": "Branch"},
        {"node_id": "node_13", "code": "deep_small", "type": "BasicBlock"},
        {"node_id": "node_14", "code": "merge", "type": "Merge"},
        {"node_id": "node_15", "code": "_", "type": "Branch"},
        {"node_id": "node_16", "code": "other", "type": "BasicBlock"},
        {"node_id": "node_17", "code": "merge", "type": "Merge"},
        {"node_id": "node_18", "code": "result1", "type": "BasicBlock"},
        {"node_id": "node_19", "code": "X > 10", "type": "Branch"},
        {"node_id": "node_20", "code": "case Y", "type": "Branch"},
        {"node_id": "node_21", "code": "ok", "type": "Branch"},
        {"node_id": "node_22", "code": "good", "type": "BasicBlock"},
        {"node_id": "node_23", "code": "error", "type": "Branch"},
        {"node_id": "node_24", "code": "bad", "type": "BasicBlock"},
        {"node_id": "node_25", "code": "merge", "type": "Merge"},
        {"node_id": "node_26", "code": "true", "type": "Branch"},
        {"node_id": "node_27", "code": "simple", "type": "BasicBlock"},
        {"node_id": "node_28", "code": "merge", "type": "Merge"},
        {"node_id": "node_29", "code": "done", "type": "BasicBlock"},
        {"node_id": "node_30", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_2", "target_id": "node_19"},
        {"source_id": "node_2", "target_id": "node_26"},
        {"source_id": "node_3", "target_id": "node_4"},
        {"source_id": "node_4", "target_id": "node_5"},
        {"source_id": "node_5", "target_id": "node_6"},
        {"source_id": "node_5", "target_id": "node_8"},
        {"source_id": "node_5", "target_id": "node_15"},
        {"source_id": "node_6", "target_id": "node_7"},
        {"source_id": "node_8", "target_id": "node_9"},
        {"source_id": "node_9", "target_id": "node_10"},
        {"source_id": "node_9", "target_id": "node_12"},
        {"source_id": "node_10", "target_id": "node_11"},
        {"source_id": "node_12", "target_id": "node_13"},
        {"source_id": "node_11", "target_id": "node_14"},
        {"source_id": "node_13", "target_id": "node_14"},
        {"source_id": "node_14", "target_id": "node_17"},
        {"source_id": "node_15", "target_id": "node_16"},
        {"source_id": "node_7", "target_id": "node_17"},
        {"source_id": "node_16", "target_id": "node_17"},
        {"source_id": "node_17", "target_id": "node_18"},
        {"source_id": "node_18", "target_id": "node_28"},
        {"source_id": "node_19", "target_id": "node_20"},
        {"source_id": "node_20", "target_id": "node_21"},
        {"source_id": "node_20", "target_id": "node_23"},
        {"source_id": "node_21", "target_id": "node_22"},
        {"source_id": "node_23", "target_id": "node_24"},
        {"source_id": "node_22", "target_id": "node_25"},
        {"source_id": "node_24", "target_id": "node_25"},
        {"source_id": "node_25", "target_id": "node_28"},
        {"source_id": "node_26", "target_id": "node_27"},
        {"source_id": "node_27", "target_id": "node_28"},
        {"source_id": "node_28", "target_id": "node_29"},
        {"source_id": "node_29", "target_id": "node_30"}
      ]
    },
    "nested_case_if_four_levels": {
      "mock": "handle(Msg, State, Config) ->\n    PreCheck = validate(Msg),\n    case PreCheck of\n        {ok, Data} ->\n            if\n                Data > 100 ->\n                    case State of\n                        active ->\n                            Result = process(Data),\n                            if\n                                Result == success -> {ok, updated};\n                                Result == retry -> {wait, State};\n                                true -> {error, unknown}\n                            end;\n                        inactive -> {skip, State};\n                        _ -> {error, bad_state}\n                    end;\n                Data > 10 ->\n                    {ok, State};\n                true ->\n                    {ignore, State}\n            end;\n        {error, Reason} ->\n            case Reason of\n                timeout -> retry;\n                invalid -> reject\n            end;\n        _ ->\n            unknown\n    end,\n    cleanup(State).",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "handle(Msg, State, Config)", "type": "Function"},
        {"node_id": "node_2", "code": "PreCheck = validate(Msg)", "type": "BasicBlock"},
        {"node_id": "node_3", "code": "case PreCheck", "type": "Branch"},
        {"node_id": "node_4", "code": "{ok, Data}", "type": "Branch"},
        {"node_id": "node_5", "code": "Data > 100", "type": "Branch"},
        {"node_id": "node_6", "code": "case State", "type": "Branch"},
        {"node_id": "node_7", "code": "active", "type": "Branch"},
        {"node_id": "node_8", "code": "Result = process(Data)", "type": "BasicBlock"},
        {"node_id": "node_9", "code": "Result == success", "type": "Branch"},
        {"node_id": "node_10", "code": "{ok, updated}", "type": "BasicBlock"},
        {"node_id": "node_11", "code": "Result == retry", "type": "Branch"},
        {"node_id": "node_12", "code": "{wait, State}", "type": "BasicBlock"},
        {"node_id": "node_13", "code": "true", "type": "Branch"},
        {"node_id": "node_14", "code": "{error, unknown}", "type": "BasicBlock"},
        {"node_id": "node_15", "code": "merge", "type": "Merge"},
        {"node_id": "node_16", "code": "inactive", "type": "Branch"},
        {"node_id": "node_17", "code": "{skip, State}", "type": "BasicBlock"},
        {"node_id": "node_18", "code": "_", "type": "Branch"},
        {"node_id": "node_19", "code": "{error, bad_state}", "type": "BasicBlock"},
        {"node_id": "node_20", "code": "merge", "type": "Merge"},
        {"node_id": "node_21", "code": "Data > 10", "type": "Branch"},
        {"node_id": "node_22", "code": "{ok, State}", "type": "BasicBlock"},
        {"node_id": "node_23", "code": "true", "type": "Branch"},
        {"node_id": "node_24", "code": "{ignore, State}", "type": "BasicBlock"},
        {"node_id": "node_25", "code": "merge", "type": "Merge"},
        {"node_id": "node_26", "code": "{error, Reason}", "type": "Branch"},
        {"node_id": "node_27", "code": "case Reason", "type": "Branch"},
        {"node_id": "node_28", "code": "timeout", "type": "Branch"},
        {"node_id": "node_29", "code": "retry", "type": "BasicBlock"},
        {"node_id": "node_30", "code": "invalid", "type": "Branch"},
        {"node_id": "node_31", "code": "reject", "type": "BasicBlock"},
        {"node_id": "node_32", "code": "merge", "type": "Merge"},
        {"node_id": "node_33", "code": "_", "type": "Branch"},
        {"node_id": "node_34", "code": "unknown", "type": "BasicBlock"},
        {"node_id": "node_35", "code": "merge", "type": "Merge"},
        {"node_id": "node_36", "code": "cleanup(State)", "type": "BasicBlock"},
        {"node_id": "node_37", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_3", "target_id": "node_4"},
        {"source_id": "node_3", "target_id": "node_26"},
        {"source_id": "node_3", "target_id": "node_33"},
        {"source_id": "node_4", "target_id": "node_5"},
        {"source_id": "node_4", "target_id": "node_21"},
        {"source_id": "node_4", "target_id": "node_23"},
        {"source_id": "node_5", "target_id": "node_6"},
        {"source_id": "node_6", "target_id": "node_7"},
        {"source_id": "node_6", "target_id": "node_16"},
        {"source_id": "node_6", "target_id": "node_18"},
        {"source_id": "node_7", "target_id": "node_8"},
        {"source_id": "node_8", "target_id": "node_9"},
        {"source_id": "node_8", "target_id": "node_11"},
        {"source_id": "node_8", "target_id": "node_13"},
        {"source_id": "node_9", "target_id": "node_10"},
        {"source_id": "node_11", "target_id": "node_12"},
        {"source_id": "node_13", "target_id": "node_14"},
        {"source_id": "node_10", "target_id": "node_15"},
        {"source_id": "node_12", "target_id": "node_15"},
        {"source_id": "node_14", "target_id": "node_15"},
        {"source_id": "node_15", "target_id": "node_20"},
        {"source_id": "node_16", "target_id": "node_17"},
        {"source_id": "node_18", "target_id": "node_19"},
        {"source_id": "node_17", "target_id": "node_20"},
        {"source_id": "node_19", "target_id": "node_20"},
        {"source_id": "node_20", "target_id": "node_25"},
        {"source_id": "node_21", "target_id": "node_22"},
        {"source_id": "node_23", "target_id": "node_24"},
        {"source_id": "node_22", "target_id": "node_25"},
        {"source_id": "node_24", "target_id": "node_25"},
        {"source_id": "node_25", "target_id": "node_35"},
        {"source_id": "node_26", "target_id": "node_27"},
        {"source_id": "node_27", "target_id": "node_28"},
        {"source_id": "node_27", "target_id": "node_30"},
        {"source_id": "node_28", "target_id": "node_29"},
        {"source_id": "node_30", "target_id": "node_31"},
        {"source_id": "node_29", "target_id": "node_32"},
        {"source_id": "node_31", "target_id": "node_32"},
        {"source_id": "node_32", "target_id": "node_35"},
        {"source_id": "node_33", "target_id": "node_34"},
        {"source_id": "node_34", "target_id": "node_35"},
        {"source_id": "node_35", "target_id": "node_36"},
        {"source_id": "node_36", "target_id": "node_37"}
      ]
    },
    "simple_receive_two_patterns": {
      "mock": "wait() ->\n    receive\n        {ok, Data} -> Data;\n        {error, Reason} -> {failed, Reason}\n    end.",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "wait()", "type": "Function"},
        {"node_id": "node_2", "code": "{ok, Data}", "type": "Branch"},
        {"node_id": "node_3", "code": "Data", "type": "BasicBlock"},
        {"node_id": "node_4", "code": "{error, Reason}", "type": "Branch"},
        {"node_id": "node_5", "code": "{failed, Reason}", "type": "BasicBlock"},
        {"node_id": "node_6", "code": "merge", "type": "Merge"},
        {"node_id": "node_7", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_1", "target_id": "node_4"},
        {"source_id": "node_4", "target_id": "node_5"},
        {"source_id": "node_3", "target_id": "node_6"},
        {"source_id": "node_5", "target_id": "node_6"},
        {"source_id": "node_6", "target_id": "node_7"}
      ]
    },
    "receive_with_timeout": {
      "mock": "wait_reply() ->\n    receive\n        {reply, Value} -> {ok, Value};\n        stop -> shutdown\n    after 5000 ->\n        timeout\n    end.",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "wait_reply()", "type": "Function"},
        {"node_id": "node_2", "code": "{reply, Value}", "type": "Branch"},
        {"node_id": "node_3", "code": "{ok, Value}", "type": "BasicBlock"},
        {"node_id": "node_4", "code": "stop", "type": "Branch"},
        {"node_id": "node_5", "code": "shutdown", "type": "BasicBlock"},
        {"node_id": "node_6", "code": "after 5000", "type": "Branch"},
        {"node_id": "node_7", "code": "timeout", "type": "BasicBlock"},
        {"node_id": "node_8", "code": "merge", "type": "Merge"},
        {"node_id": "node_9", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_1", "target_id": "node_4"},
        {"source_id": "node_1", "target_id": "node_6"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_4", "target_id": "node_5"},
        {"source_id": "node_6", "target_id": "node_7"},
        {"source_id": "node_3", "target_id": "node_8"},
        {"source_id": "node_5", "target_id": "node_8"},
        {"source_id": "node_7", "target_id": "node_8"},
        {"source_id": "node_8", "target_id": "node_9"}
      ]
    },
    "complex_receive_case_if_nested": {
      "mock": "handle(State) ->\n    Init = setup(),\n    receive\n        {command, Cmd} ->\n            case Cmd of\n                start ->\n                    if\n                        State == ready -> running;\n                        true -> {error, not_ready}\n                    end;\n                stop -> stopped\n            end;\n        {query, Q} -> process_query(Q);\n        timeout -> expired\n    after 10000 ->\n        no_message\n    end,\n    cleanup().",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "handle(State)", "type": "Function"},
        {"node_id": "node_2", "code": "Init = setup()", "type": "BasicBlock"},
        {"node_id": "node_3", "code": "{command, Cmd}", "type": "Branch"},
        {"node_id": "node_4", "code": "case Cmd", "type": "Branch"},
        {"node_id": "node_5", "code": "start", "type": "Branch"},
        {"node_id": "node_6", "code": "State == ready", "type": "Branch"},
        {"node_id": "node_7", "code": "running", "type": "BasicBlock"},
        {"node_id": "node_8", "code": "true", "type": "Branch"},
        {"node_id": "node_9", "code": "{error, not_ready}", "type": "BasicBlock"},
        {"node_id": "node_10", "code": "merge", "type": "Merge"},
        {"node_id": "node_11", "code": "stop", "type": "Branch"},
        {"node_id": "node_12", "code": "stopped", "type": "BasicBlock"},
        {"node_id": "node_13", "code": "merge", "type": "Merge"},
        {"node_id": "node_14", "code": "{query, Q}", "type": "Branch"},
        {"node_id": "node_15", "code": "process_query(Q)", "type": "BasicBlock"},
        {"node_id": "node_16", "code": "timeout", "type": "Branch"},
        {"node_id": "node_17", "code": "expired", "type": "BasicBlock"},
        {"node_id": "node_18", "code": "after 10000", "type": "Branch"},
        {"node_id": "node_19", "code": "no_message", "type": "BasicBlock"},
        {"node_id": "node_20", "code": "merge", "type": "Merge"},
        {"node_id": "node_21", "code": "cleanup()", "type": "BasicBlock"},
        {"node_id": "node_22", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_2", "target_id": "node_14"},
        {"source_id": "node_2", "target_id": "node_16"},
        {"source_id": "node_2", "target_id": "node_18"},
        {"source_id": "node_3", "target_id": "node_4"},
        {"source_id": "node_4", "target_id": "node_5"},
        {"source_id": "node_4", "target_id": "node_11"},
        {"source_id": "node_5", "target_id": "node_6"},
        {"source_id": "node_5", "target_id": "node_8"},
        {"source_id": "node_6", "target_id": "node_7"},
        {"source_id": "node_8", "target_id": "node_9"},
        {"source_id": "node_7", "target_id": "node_10"},
        {"source_id": "node_9", "target_id": "node_10"},
        {"source_id": "node_10", "target_id": "node_13"},
        {"source_id": "node_11", "target_id": "node_12"},
        {"source_id": "node_12", "target_id": "node_13"},
        {"source_id": "node_13", "target_id": "node_20"},
        {"source_id": "node_14", "target_id": "node_15"},
        {"source_id": "node_15", "target_id": "node_20"},
        {"source_id": "node_16", "target_id": "node_17"},
        {"source_id": "node_17", "target_id": "node_20"},
        {"source_id": "node_18", "target_id": "node_19"},
        {"source_id": "node_19", "target_id": "node_20"},
        {"source_id": "node_20", "target_id": "node_21"},
        {"source_id": "node_21", "target_id": "node_22"}
      ]
    },
    "simple_try_catch": {
      "mock": "safe_divide(A, B) ->\n    try\n        A / B\n    catch\n        error:badarith -> {error, division_by_zero}\n    end.",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "safe_divide(A, B)", "type": "Function"},
        {"node_id": "node_2", "code": "A / B", "type": "BasicBlock"},
        {"node_id": "node_3", "code": "error:badarith", "type": "Branch"},
        {"node_id": "node_4", "code": "{error, division_by_zero}", "type": "BasicBlock"},
        {"node_id": "node_5", "code": "merge", "type": "Merge"},
        {"node_id": "node_6", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_2", "target_id": "node_5"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_3", "target_id": "node_4"},
        {"source_id": "node_4", "target_id": "node_5"},
        {"source_id": "node_5", "target_id": "node_6"}
      ]
    },
    "try_catch_multiple_handlers": {
      "mock": "safe_call() ->\n    try\n        risky_operation()\n    catch\n        error:timeout -> retry;\n        error:network -> offline;\n        _:_ -> unknown_error\n    end.",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "safe_call()", "type": "Function"},
        {"node_id": "node_2", "code": "risky_operation()", "type": "BasicBlock"},
        {"node_id": "node_3", "code": "error:timeout", "type": "Branch"},
        {"node_id": "node_4", "code": "retry", "type": "BasicBlock"},
        {"node_id": "node_5", "code": "error:network", "type": "Branch"},
        {"node_id": "node_6", "code": "offline", "type": "BasicBlock"},
        {"node_id": "node_7", "code": "_:_", "type": "Branch"},
        {"node_id": "node_8", "code": "unknown_error", "type": "BasicBlock"},
        {"node_id": "node_9", "code": "merge", "type": "Merge"},
        {"node_id": "node_10", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_2", "target_id": "node_9"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_2", "target_id": "node_5"},
        {"source_id": "node_2", "target_id": "node_7"},
        {"source_id": "node_3", "target_id": "node_4"},
        {"source_id": "node_5", "target_id": "node_6"},
        {"source_id": "node_7", "target_id": "node_8"},
        {"source_id": "node_4", "target_id": "node_9"},
        {"source_id": "node_6", "target_id": "node_9"},
        {"source_id": "node_8", "target_id": "node_9"},
        {"source_id": "node_9", "target_id": "node_10"}
      ]
    },
    "try_catch_with_after": {
      "mock": "process_file(File) ->\n    try\n        read_file(File)\n    catch\n        error:enoent -> {error, not_found}\n    after\n        close_handle()\n    end.",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "process_file(File)", "type": "Function"},
        {"node_id": "node_2", "code": "read_file(File)", "type": "BasicBlock"},
        {"node_id": "node_3", "code": "error:enoent", "type": "Branch"},
        {"node_id": "node_4", "code": "{error, not_found}", "type": "BasicBlock"},
        {"node_id": "node_5", "code": "merge", "type": "Merge"},
        {"node_id": "node_6", "code": "close_handle()", "type": "BasicBlock"},
        {"node_id": "node_7", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_2", "target_id": "node_5"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_3", "target_id": "node_4"},
        {"source_id": "node_4", "target_id": "node_5"},
        {"source_id": "node_5", "target_id": "node_6"},
        {"source_id": "node_6", "target_id": "node_7"}
      ]
    },
    "try_after_no_catch": {
      "mock": "safe_work() ->\n    try\n        do_work()\n    after\n        cleanup()\n    end.",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "safe_work()", "type": "Function"},
        {"node_id": "node_2", "code": "do_work()", "type": "BasicBlock"},
        {"node_id": "node_3", "code": "cleanup()", "type": "BasicBlock"},
        {"node_id": "node_4", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_3", "target_id": "node_4"}
      ]
    },
    "try_after_no_catch_sequential": {
      "mock": "process() ->\n    Init = setup(),\n    try\n        step1(),\n        step2()\n    after\n        cleanup(),\n        log()\n    end,\n    done.",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "process()", "type": "Function"},
        {"node_id": "node_2", "code": "Init = setup()", "type": "BasicBlock"},
        {"node_id": "node_3", "code": "step1()", "type": "BasicBlock"},
        {"node_id": "node_4", "code": "step2()", "type": "BasicBlock"},
        {"node_id": "node_5", "code": "cleanup()", "type": "BasicBlock"},
        {"node_id": "node_6", "code": "log()", "type": "BasicBlock"},
        {"node_id": "node_7", "code": "done", "type": "BasicBlock"},
        {"node_id": "node_8", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_3", "target_id": "node_4"},
        {"source_id": "node_4", "target_id": "node_5"},
        {"source_id": "node_5", "target_id": "node_6"},
        {"source_id": "node_6", "target_id": "node_7"},
        {"source_id": "node_7", "target_id": "node_8"}
      ]
    },
    "try_after_with_nested_case": {
      "mock": "handle(X) ->\n    try\n        case X of\n            ok -> success;\n            error -> failed\n        end\n    after\n        cleanup()\n    end.",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "handle(X)", "type": "Function"},
        {"node_id": "node_2", "code": "case X", "type": "Branch"},
        {"node_id": "node_3", "code": "ok", "type": "Branch"},
        {"node_id": "node_4", "code": "success", "type": "BasicBlock"},
        {"node_id": "node_5", "code": "error", "type": "Branch"},
        {"node_id": "node_6", "code": "failed", "type": "BasicBlock"},
        {"node_id": "node_7", "code": "merge", "type": "Merge"},
        {"node_id": "node_8", "code": "cleanup()", "type": "BasicBlock"},
        {"node_id": "node_9", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_2", "target_id": "node_5"},
        {"source_id": "node_3", "target_id": "node_4"},
        {"source_id": "node_5", "target_id": "node_6"},
        {"source_id": "node_4", "target_id": "node_7"},
        {"source_id": "node_6", "target_id": "node_7"},
        {"source_id": "node_7", "target_id": "node_8"},
        {"source_id": "node_8", "target_id": "node_9"}
      ]
    },
    "try_of_simple": {
      "mock": "call() ->\n    try\n        risky_op()\n    of\n        {ok, Val} -> Val;\n        {error, Err} -> Err\n    catch\n        error:badarg -> invalid\n    end.",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "call()", "type": "Function"},
        {"node_id": "node_2", "code": "risky_op()", "type": "BasicBlock"},
        {"node_id": "node_3", "code": "{ok, Val}", "type": "Branch"},
        {"node_id": "node_4", "code": "Val", "type": "BasicBlock"},
        {"node_id": "node_5", "code": "{error, Err}", "type": "Branch"},
        {"node_id": "node_6", "code": "Err", "type": "BasicBlock"},
        {"node_id": "node_7", "code": "merge", "type": "Merge"},
        {"node_id": "node_8", "code": "error:badarg", "type": "Branch"},
        {"node_id": "node_9", "code": "invalid", "type": "BasicBlock"},
        {"node_id": "node_10", "code": "merge", "type": "Merge"},
        {"node_id": "node_11", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_2", "target_id": "node_5"},
        {"source_id": "node_3", "target_id": "node_4"},
        {"source_id": "node_5", "target_id": "node_6"},
        {"source_id": "node_4", "target_id": "node_7"},
        {"source_id": "node_6", "target_id": "node_7"},
        {"source_id": "node_2", "target_id": "node_8"},
        {"source_id": "node_8", "target_id": "node_9"},
        {"source_id": "node_7", "target_id": "node_10"},
        {"source_id": "node_9", "target_id": "node_10"},
        {"source_id": "node_10", "target_id": "node_11"}
      ]
    },
    "try_of_with_after": {
      "mock": "safe() ->\n    try\n        work()\n    of\n        ok -> success\n    catch\n        _:_ -> failed\n    after\n        cleanup()\n    end.",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "safe()", "type": "Function"},
        {"node_id": "node_2", "code": "work()", "type": "BasicBlock"},
        {"node_id": "node_3", "code": "ok", "type": "Branch"},
        {"node_id": "node_4", "code": "success", "type": "BasicBlock"},
        {"node_id": "node_5", "code": "merge", "type": "Merge"},
        {"node_id": "node_6", "code": "_:_", "type": "Branch"},
        {"node_id": "node_7", "code": "failed", "type": "BasicBlock"},
        {"node_id": "node_8", "code": "merge", "type": "Merge"},
        {"node_id": "node_9", "code": "cleanup()", "type": "BasicBlock"},
        {"node_id": "node_10", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_3", "target_id": "node_4"},
        {"source_id": "node_4", "target_id": "node_5"},
        {"source_id": "node_2", "target_id": "node_6"},
        {"source_id": "node_6", "target_id": "node_7"},
        {"source_id": "node_5", "target_id": "node_8"},
        {"source_id": "node_7", "target_id": "node_8"},
        {"source_id": "node_8", "target_id": "node_9"},
        {"source_id": "node_9", "target_id": "node_10"}
      ]
    },
    "nested_try_in_try_body": {
      "mock": "nested() ->\n    try\n        try\n            inner_risky()\n        catch\n            error:inner -> inner_handled\n        end\n    catch\n        error:outer -> outer_handled\n    end.",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "nested()", "type": "Function"},
        {"node_id": "node_2", "code": "inner_risky()", "type": "BasicBlock"},
        {"node_id": "node_3", "code": "error:inner", "type": "Branch"},
        {"node_id": "node_4", "code": "inner_handled", "type": "BasicBlock"},
        {"node_id": "node_5", "code": "merge", "type": "Merge"},
        {"node_id": "node_6", "code": "error:outer", "type": "Branch"},
        {"node_id": "node_7", "code": "outer_handled", "type": "BasicBlock"},
        {"node_id": "node_8", "code": "merge", "type": "Merge"},
        {"node_id": "node_9", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_3", "target_id": "node_4"},
        {"source_id": "node_2", "target_id": "node_5"},
        {"source_id": "node_4", "target_id": "node_5"},
        {"source_id": "node_5", "target_id": "node_6"},
        {"source_id": "node_6", "target_id": "node_7"},
        {"source_id": "node_5", "target_id": "node_8"},
        {"source_id": "node_7", "target_id": "node_8"},
        {"source_id": "node_8", "target_id": "node_9"}
      ]
    },
    "nested_try_in_catch_handler": {
      "mock": "handle() ->\n    try\n        risky()\n    catch\n        error:main ->\n            try\n                recover()\n            catch\n                error:recovery -> failed\n            end\n    end.",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "handle()", "type": "Function"},
        {"node_id": "node_2", "code": "risky()", "type": "BasicBlock"},
        {"node_id": "node_3", "code": "error:main", "type": "Branch"},
        {"node_id": "node_4", "code": "recover()", "type": "BasicBlock"},
        {"node_id": "node_5", "code": "error:recovery", "type": "Branch"},
        {"node_id": "node_6", "code": "failed", "type": "BasicBlock"},
        {"node_id": "node_7", "code": "merge", "type": "Merge"},
        {"node_id": "node_8", "code": "merge", "type": "Merge"},
        {"node_id": "node_9", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_3", "target_id": "node_4"},
        {"source_id": "node_4", "target_id": "node_5"},
        {"source_id": "node_5", "target_id": "node_6"},
        {"source_id": "node_4", "target_id": "node_7"},
        {"source_id": "node_6", "target_id": "node_7"},
        {"source_id": "node_2", "target_id": "node_8"},
        {"source_id": "node_7", "target_id": "node_8"},
        {"source_id": "node_8", "target_id": "node_9"}
      ]
    },
    "nested_try_complex": {
      "mock": "complex() ->\n    try\n        case check() of\n            ok ->\n                try\n                    process()\n                catch\n                    error:E -> {error, E}\n                end;\n            error -> skip\n        end\n    catch\n        _:_ -> total_failure\n    after\n        cleanup()\n    end.",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "complex()", "type": "Function"},
        {"node_id": "node_2", "code": "case check()", "type": "Branch"},
        {"node_id": "node_3", "code": "ok", "type": "Branch"},
        {"node_id": "node_4", "code": "process()", "type": "BasicBlock"},
        {"node_id": "node_5", "code": "error:E", "type": "Branch"},
        {"node_id": "node_6", "code": "{error, E}", "type": "BasicBlock"},
        {"node_id": "node_7", "code": "merge", "type": "Merge"},
        {"node_id": "node_8", "code": "error", "type": "Branch"},
        {"node_id": "node_9", "code": "skip", "type": "BasicBlock"},
        {"node_id": "node_10", "code": "merge", "type": "Merge"},
        {"node_id": "node_11", "code": "_:_", "type": "Branch"},
        {"node_id": "node_12", "code": "total_failure", "type": "BasicBlock"},
        {"node_id": "node_13", "code": "merge", "type": "Merge"},
        {"node_id": "node_14", "code": "cleanup()", "type": "BasicBlock"},
        {"node_id": "node_15", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_2", "target_id": "node_8"},
        {"source_id": "node_3", "target_id": "node_4"},
        {"source_id": "node_4", "target_id": "node_5"},
        {"source_id": "node_5", "target_id": "node_6"},
        {"source_id": "node_4", "target_id": "node_7"},
        {"source_id": "node_6", "target_id": "node_7"},
        {"source_id": "node_7", "target_id": "node_10"},
        {"source_id": "node_8", "target_id": "node_9"},
        {"source_id": "node_9", "target_id": "node_10"},
        {"source_id": "node_10", "target_id": "node_11"},
        {"source_id": "node_11", "target_id": "node_12"},
        {"source_id": "node_10", "target_id": "node_13"},
        {"source_id": "node_12", "target_id": "node_13"},
        {"source_id": "node_13", "target_id": "node_14"},
        {"source_id": "node_14", "target_id": "node_15"}
      ]
    },
    "try_of_after_no_catch": {
      "mock": "process() ->\n    try\n        work()\n    of\n        {ok, Result} -> Result;\n        error -> failed\n    after\n        cleanup()\n    end.",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "process()", "type": "Function"},
        {"node_id": "node_2", "code": "work()", "type": "BasicBlock"},
        {"node_id": "node_3", "code": "{ok, Result}", "type": "Branch"},
        {"node_id": "node_4", "code": "Result", "type": "BasicBlock"},
        {"node_id": "node_5", "code": "error", "type": "Branch"},
        {"node_id": "node_6", "code": "failed", "type": "BasicBlock"},
        {"node_id": "node_7", "code": "merge", "type": "Merge"},
        {"node_id": "node_8", "code": "cleanup()", "type": "BasicBlock"},
        {"node_id": "node_9", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_2", "target_id": "node_5"},
        {"source_id": "node_3", "target_id": "node_4"},
        {"source_id": "node_5", "target_id": "node_6"},
        {"source_id": "node_4", "target_id": "node_7"},
        {"source_id": "node_6", "target_id": "node_7"},
        {"source_id": "node_7", "target_id": "node_8"},
        {"source_id": "node_8", "target_id": "node_9"}
      ]
    },
    "try_empty_catch_with_after": {
      "mock": "handle() ->\n    try\n        risky()\n    catch\n    after\n        cleanup()\n    end.",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "handle()", "type": "Function"},
        {"node_id": "node_2", "code": "risky()", "type": "BasicBlock"},
        {"node_id": "node_3", "code": "cleanup()", "type": "BasicBlock"},
        {"node_id": "node_4", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_3", "target_id": "node_4"}
      ]
    },
    "simple_maybe_no_else": {
      "mock": "check() ->\n    maybe\n        {ok, X} ?= get_value(),\n        X > 10\n    end.",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "check()", "type": "Function"},
        {"node_id": "node_2", "code": "{ok, X} ?= get_value()", "type": "BasicBlock"},
        {"node_id": "node_3", "code": "X > 10", "type": "BasicBlock"},
        {"node_id": "node_4", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_3", "target_id": "node_4"}
      ]
    },
    "maybe_with_else": {
      "mock": "process() ->\n    maybe\n        {ok, X} ?= fetch(),\n        X > 5\n    else\n        {error, R} -> {failed, R};\n        false -> too_small\n    end.",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "process()", "type": "Function"},
        {"node_id": "node_2", "code": "{ok, X} ?= fetch()", "type": "BasicBlock"},
        {"node_id": "node_3", "code": "X > 5", "type": "BasicBlock"},
        {"node_id": "node_4", "code": "{error, R}", "type": "Branch"},
        {"node_id": "node_5", "code": "{failed, R}", "type": "BasicBlock"},
        {"node_id": "node_6", "code": "false", "type": "Branch"},
        {"node_id": "node_7", "code": "too_small", "type": "BasicBlock"},
        {"node_id": "node_8", "code": "merge", "type": "Merge"},
        {"node_id": "node_9", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_3", "target_id": "node_4"},
        {"source_id": "node_3", "target_id": "node_6"},
        {"source_id": "node_4", "target_id": "node_5"},
        {"source_id": "node_4", "target_id": "node_8"},
        {"source_id": "node_6", "target_id": "node_7"},
        {"source_id": "node_6", "target_id": "node_8"},
        {"source_id": "node_3", "target_id": "node_8"},
        {"source_id": "node_5", "target_id": "node_8"},
        {"source_id": "node_7", "target_id": "node_8"},
        {"source_id": "node_8", "target_id": "node_9"}
      ]
    },
    "nested_maybe_in_maybe": {
      "mock": "nested() ->\n    maybe\n        {ok, X} ?= outer(),\n        maybe\n            {ok, Y} ?= inner(X),\n            Y > 10\n        else\n            {error, E} -> {inner_failed, E}\n        end\n    else\n        {error, R} -> {outer_failed, R}\n    end.",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "nested()", "type": "Function"},
        {"node_id": "node_2", "code": "{ok, X} ?= outer()", "type": "BasicBlock"},
        {"node_id": "node_3", "code": "{ok, Y} ?= inner(X)", "type": "BasicBlock"},
        {"node_id": "node_4", "code": "Y > 10", "type": "BasicBlock"},
        {"node_id": "node_5", "code": "{error, E}", "type": "Branch"},
        {"node_id": "node_6", "code": "{inner_failed, E}", "type": "BasicBlock"},
        {"node_id": "node_7", "code": "merge", "type": "Merge"},
        {"node_id": "node_8", "code": "{error, R}", "type": "Branch"},
        {"node_id": "node_9", "code": "{outer_failed, R}", "type": "BasicBlock"},
        {"node_id": "node_10", "code": "merge", "type": "Merge"},
        {"node_id": "node_11", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_3", "target_id": "node_4"},
        {"source_id": "node_4", "target_id": "node_5"},
        {"source_id": "node_5", "target_id": "node_6"},
        {"source_id": "node_4", "target_id": "node_7"},
        {"source_id": "node_6", "target_id": "node_7"},
        {"source_id": "node_5", "target_id": "node_7"},
        {"source_id": "node_7", "target_id": "node_8"},
        {"source_id": "node_8", "target_id": "node_9"},
        {"source_id": "node_7", "target_id": "node_10"},
        {"source_id": "node_9", "target_id": "node_10"},
        {"source_id": "node_8", "target_id": "node_10"},
        {"source_id": "node_10", "target_id": "node_11"}
      ]
    },
    "maybe_nested_in_case": {
      "mock": "handle(X) ->\n    case X of\n        check ->\n            maybe\n                {ok, V} ?= validate(),\n                V > 0\n            else\n                {error, R} -> invalid\n            end;\n        skip -> ok\n    end.",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "handle(X)", "type": "Function"},
        {"node_id": "node_2", "code": "case X", "type": "Branch"},
        {"node_id": "node_3", "code": "check", "type": "Branch"},
        {"node_id": "node_4", "code": "{ok, V} ?= validate()", "type": "BasicBlock"},
        {"node_id": "node_5", "code": "V > 0", "type": "BasicBlock"},
        {"node_id": "node_6", "code": "{error, R}", "type": "Branch"},
        {"node_id": "node_7", "code": "invalid", "type": "BasicBlock"},
        {"node_id": "node_8", "code": "merge", "type": "Merge"},
        {"node_id": "node_9", "code": "skip", "type": "Branch"},
        {"node_id": "node_10", "code": "ok", "type": "BasicBlock"},
        {"node_id": "node_11", "code": "merge", "type": "Merge"},
        {"node_id": "node_12", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_2", "target_id": "node_9"},
        {"source_id": "node_3", "target_id": "node_4"},
        {"source_id": "node_4", "target_id": "node_5"},
        {"source_id": "node_5", "target_id": "node_6"},
        {"source_id": "node_6", "target_id": "node_7"},
        {"source_id": "node_6", "target_id": "node_8"},
        {"source_id": "node_5", "target_id": "node_8"},
        {"source_id": "node_7", "target_id": "node_8"},
        {"source_id": "node_8", "target_id": "node_11"},
        {"source_id": "node_9", "target_id": "node_10"},
        {"source_id": "node_10", "target_id": "node_11"},
        {"source_id": "node_11", "target_id": "node_12"}
      ]
    },
    "maybe_nested_in_if": {
      "mock": "check(X) ->\n    if\n        X > 10 ->\n            maybe\n                {ok, V} ?= process(X),\n                V\n            else\n                error -> failed\n            end;\n        true -> skip\n    end.",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "check(X)", "type": "Function"},
        {"node_id": "node_2", "code": "X > 10", "type": "Branch"},
        {"node_id": "node_3", "code": "{ok, V} ?= process(X)", "type": "BasicBlock"},
        {"node_id": "node_4", "code": "V", "type": "BasicBlock"},
        {"node_id": "node_5", "code": "error", "type": "Branch"},
        {"node_id": "node_6", "code": "failed", "type": "BasicBlock"},
        {"node_id": "node_7", "code": "merge", "type": "Merge"},
        {"node_id": "node_8", "code": "true", "type": "Branch"},
        {"node_id": "node_9", "code": "skip", "type": "BasicBlock"},
        {"node_id": "node_10", "code": "merge", "type": "Merge"},
        {"node_id": "node_11", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_1", "target_id": "node_8"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_3", "target_id": "node_4"},
        {"source_id": "node_4", "target_id": "node_5"},
        {"source_id": "node_5", "target_id": "node_6"},
        {"source_id": "node_4", "target_id": "node_7"},
        {"source_id": "node_6", "target_id": "node_7"},
        {"source_id": "node_5", "target_id": "node_7"},
        {"source_id": "node_8", "target_id": "node_9"},
        {"source_id": "node_7", "target_id": "node_10"},
        {"source_id": "node_9", "target_id": "node_10"},
        {"source_id": "node_10", "target_id": "node_11"}
      ]
    },
    "maybe_nested_in_try": {
      "mock": "safe() ->\n    try\n        maybe\n            {ok, X} ?= risky(),\n            X\n        else\n            error -> retry\n        end\n    catch\n        _:_ -> failed\n    end.",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "safe()", "type": "Function"},
        {"node_id": "node_2", "code": "{ok, X} ?= risky()", "type": "BasicBlock"},
        {"node_id": "node_3", "code": "X", "type": "BasicBlock"},
        {"node_id": "node_4", "code": "error", "type": "Branch"},
        {"node_id": "node_5", "code": "retry", "type": "BasicBlock"},
        {"node_id": "node_6", "code": "merge", "type": "Merge"},
        {"node_id": "node_7", "code": "_:_", "type": "Branch"},
        {"node_id": "node_8", "code": "failed", "type": "BasicBlock"},
        {"node_id": "node_9", "code": "merge", "type": "Merge"},
        {"node_id": "node_10", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_3", "target_id": "node_4"},
        {"source_id": "node_4", "target_id": "node_5"},
        {"source_id": "node_3", "target_id": "node_6"},
        {"source_id": "node_5", "target_id": "node_6"},
        {"source_id": "node_4", "target_id": "node_6"},
        {"source_id": "node_6", "target_id": "node_7"},
        {"source_id": "node_7", "target_id": "node_8"},
        {"source_id": "node_6", "target_id": "node_9"},
        {"source_id": "node_8", "target_id": "node_9"},
        {"source_id": "node_9", "target_id": "node_10"}
      ]
    },
    "maybe_nested_in_receive": {
      "mock": "wait() ->\n    receive\n        {check, X} ->\n            maybe\n                {ok, V} ?= validate(X),\n                V\n            else\n                error -> invalid\n            end;\n        stop -> done\n    end.",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "wait()", "type": "Function"},
        {"node_id": "node_2", "code": "{check, X}", "type": "Branch"},
        {"node_id": "node_3", "code": "{ok, V} ?= validate(X)", "type": "BasicBlock"},
        {"node_id": "node_4", "code": "V", "type": "BasicBlock"},
        {"node_id": "node_5", "code": "error", "type": "Branch"},
        {"node_id": "node_6", "code": "invalid", "type": "BasicBlock"},
        {"node_id": "node_7", "code": "merge", "type": "Merge"},
        {"node_id": "node_8", "code": "stop", "type": "Branch"},
        {"node_id": "node_9", "code": "done", "type": "BasicBlock"},
        {"node_id": "node_10", "code": "merge", "type": "Merge"},
        {"node_id": "node_11", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_1", "target_id": "node_8"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_3", "target_id": "node_4"},
        {"source_id": "node_4", "target_id": "node_5"},
        {"source_id": "node_5", "target_id": "node_6"},
        {"source_id": "node_4", "target_id": "node_7"},
        {"source_id": "node_6", "target_id": "node_7"},
        {"source_id": "node_5", "target_id": "node_7"},
        {"source_id": "node_7", "target_id": "node_10"},
        {"source_id": "node_8", "target_id": "node_9"},
        {"source_id": "node_9", "target_id": "node_10"},
        {"source_id": "node_10", "target_id": "node_11"}
      ]
    },
    "try_with_multiple_expressions_in_body": {
      "mock": "safe_set(Hash, Data, State) ->\n    Handle = State#state.handle,\n    CodeGen = State#state.codegen,\n    try\n        OldData = CodeGen:get_current_definitions(Handle),\n        ok = CodeGen:generate(Handle, Data),\n        {ok, OldData, State#state{hash = Hash}}\n    catch\n        Class:Reason ->\n            {{Class, Reason}, State}\n    end.",
      "expected_nodes": [
        {"node_id": "node_0", "code": "Entry", "type": "Entry"},
        {"node_id": "node_1", "code": "safe_set(Hash, Data, State)", "type": "Function"},
        {"node_id": "node_2", "code": "Handle = State#state.handle", "type": "BasicBlock"},
        {"node_id": "node_3", "code": "CodeGen = State#state.codegen", "type": "BasicBlock"},
        {"node_id": "node_4", "code": "OldData = CodeGen:get_current_definitions(Handle)", "type": "BasicBlock"},
        {"node_id": "node_5", "code": "ok = CodeGen:generate(Handle, Data)", "type": "BasicBlock"},
        {"node_id": "node_6", "code": "{ok, OldData, State#state{hash = Hash}}", "type": "BasicBlock"},
        {"node_id": "node_7", "code": "Class:Reason", "type": "Branch"},
        {"node_id": "node_8", "code": "{{Class, Reason}, State}", "type": "BasicBlock"},
        {"node_id": "node_9", "code": "merge", "type": "Merge"},
        {"node_id": "node_10", "code": "Exit", "type": "Exit"}
      ],
      "expected_edges": [
        {"source_id": "node_0", "target_id": "node_1"},
        {"source_id": "node_1", "target_id": "node_2"},
        {"source_id": "node_2", "target_id": "node_3"},
        {"source_id": "node_3", "target_id": "node_4"},
        {"source_id": "node_4", "target_id": "node_5"},
        {"source_id": "node_5", "target_id": "node_6"},
        {"source_id": "node_6", "target_id": "node_9"},
        {"source_id": "node_4", "target_id": "node_7"},
        {"source_id": "node_5", "target_id": "node_7"},
        {"source_id": "node_6", "target_id": "node_7"},
        {"source_id": "node_7", "target_id": "node_8"},
        {"source_id": "node_8", "target_id": "node_9"},
        {"source_id": "node_9", "target_id": "node_10"}
      ]
    }
  }
}